<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>INDETEC ¬∑ Datos Hacendarios ¬∑ Reportes PBI</title>
<meta name="color-scheme" content="light dark">

<!-- üîå Preconexiones (reduce latencia al hacer clic/redirigir) -->
<link rel="dns-prefetch" href="https://script.google.com">
<link rel="preconnect" href="https://script.google.com" crossorigin>
<link rel="dns-prefetch" href="https://app.powerbi.com">
<link rel="preconnect" href="https://app.powerbi.com" crossorigin>

<style>
  :root{--bg:#fff;--fg:#111;--muted:#667;--card:#f6f7fb;--border:#e6e8ef;--accent:#2f6fed}
  @media (prefers-color-scheme:dark){
    :root{--bg:#0b0d12;--fg:#eaeef8;--muted:#98a0b3;--card:#121621;--border:#22283a;--accent:#6aa7ff}
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--fg);font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
  header{position:sticky;top:0;background:var(--bg);border-bottom:1px solid var(--border);z-index:10}
  .wrap{max-width:1100px;margin:0 auto;padding:16px}
  h1{font-size:1.2rem;margin:0 0 6px}
  .sub{color:var(--muted);font-size:.92rem;margin:0}
  .toolbar{display:grid;grid-template-columns:1fr auto auto;gap:10px;margin-top:12px}
  input[type=search]{padding:10px 12px;border:1px solid var(--border);border-radius:10px;background:var(--card);color:var(--fg)}
  .btn{padding:10px 12px;border:1px solid var(--border);border-radius:10px;background:transparent;color:var(--fg);cursor:pointer}
  .btn[aria-pressed=true]{border-color:var(--accent);color:var(--accent)}
  main{padding:18px 0}
  .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
  @media (max-width:920px){.grid{grid-template-columns:repeat(2,1fr)}}
  @media (max-width:640px){.grid{grid-template-columns:1fr}}
  .card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:14px;display:flex;flex-direction:column;gap:10px}
  .title{margin:0;font-size:1rem}
  .id{font-family:ui-monospace,Menlo,Consolas,monospace;font-size:.76rem;color:var(--muted)}
  .meta{display:flex;gap:8px;flex-wrap:wrap}
  .tag{font-size:.75rem;color:var(--muted);padding:2px 8px;border:1px solid var(--border);border-radius:999px}
  .actions{display:flex;gap:8px;margin-top:auto}
  .a{flex:1;text-align:center;text-decoration:none;border:1px solid var(--border);border-radius:10px;padding:9px}
  .a.primary{background:var(--accent);border-color:var(--accent);color:#fff}
  .hint{color:var(--muted);font-size:.85rem}
  .empty{padding:24px;color:var(--muted)}
</style>
</head>
<body>
<header>
  <div class="wrap">
    <h1>Datos Hacendarios ¬∑ Reportes Power BI</h1>
    <p class="sub">Enlaces con dominio GitHub ‚Üí registro en Apps Script ‚Üí redirecci√≥n a Power BI.</p>
    <div class="toolbar" role="region" aria-label="Herramientas">
      <input id="q" type="search" placeholder="Buscar‚Ä¶ (Ej.: EFIPem, predial, pe_2000_2023)" autocomplete="off" aria-label="Buscar">
      <button id="toggleGroup" class="btn" aria-pressed="true" title="Agrupar por categor√≠a">Agrupar</button>
      <button id="toggleIds" class="btn" aria-pressed="false" title="Mostrar IDs">IDs</button>
    </div>
  </div>
</header>

<main>
  <div class="wrap">
    <!-- üßæ Contenido EST√ÅTICO (ya usable sin JS) -->
    <div id="static" class="grid">
      <!-- Generado a mano para time-to-first-byte m√≠nimo; JS lo mejorar√° luego -->
      <article class="card"><h3 class="title">Pron√≥sticos</h3><div class="meta"><span class="tag">PBI</span></div><div class="actions"><a class="a primary" href="./go.html?id=pronosticos">Abrir</a></div></article>
      <article class="card"><h3 class="title">Impuestos potenciales</h3><div class="meta"><span class="tag">PBI</span></div><div class="actions"><a class="a primary" href="./go.html?id=impuestos_potenciales">Abrir</a></div></article>
      <article class="card"><h3 class="title">Mapas</h3><div class="meta"><span class="tag">PBI</span></div><div class="actions"><a class="a primary" href="./go.html?id=mapas">Abrir</a></div></article>
      <article class="card"><h3 class="title">Indicadores</h3><div class="meta"><span class="tag">PBI</span></div><div class="actions"><a class="a primary" href="./go.html?id=indicadores">Abrir</a></div></article>
      <article class="card"><h3 class="title">Panorama de la Hacienda P√∫blica</h3><div class="meta"><span class="tag">PBI</span></div><div class="actions"><a class="a primary" href="./go.html?id=panorama_hacienda">Abrir</a></div></article>
      <article class="card"><h3 class="title">Ambientales</h3><div class="meta"><span class="tag">PBI</span></div><div class="actions"><a class="a primary" href="./go.html?id=ambientales">Abrir</a></div></article>
      <article class="card"><h3 class="title">Deuda</h3><div class="meta"><span class="tag">PBI</span></div><div class="actions"><a class="a primary" href="./go.html?id=deuda">Abrir</a></div></article>
      <article class="card"><h3 class="title">Municipal</h3><div class="meta"><span class="tag">PBI</span></div><div class="actions"><a class="a primary" href="./go.html?id=municipal">Abrir</a></div></article>

      <article class="card"><h3 class="title">PE por cap√≠tulo 2015‚Äì2024</h3><div class="meta"><span class="tag">PBI</span></div><div class="actions"><a class="a primary" href="./go.html?id=pe_cap_2015_2024">Abrir</a></div></article>
      <article class="card"><h3 class="title">PE 2000‚Äì2023</h3><div class="meta"><span class="tag">PBI</span></div><div class="actions"><a class="a primary" href="./go.html?id=pe_2000_2023">Abrir</a></div></article>
      <article class="card"><h3 class="title">PE por entidad</h3><div class="meta"><span class="tag">PBI</span></div><div class="actions"><a class="a primary" href="./go.html?id=pe_entidades">Abrir</a></div></article>
      <article class="card"><h3 class="title">EFIPEM 1989‚Äì2024</h3><div class="meta"><span class="tag">PBI</span></div><div class="actions"><a class="a primary" href="./go.html?id=efipem_1989_2024">Abrir</a></div></article>
      <article class="card"><h3 class="title">EFIPEM 1989‚Äì2023</h3><div class="meta"><span class="tag">PBI</span></div><div class="actions"><a class="a primary" href="./go.html?id=efipem_1989_2023">Abrir</a></div></article>
      <article class="card"><h3 class="title">EFIPEM 2023</h3><div class="meta"><span class="tag">PBI</span></div><div class="actions"><a class="a primary" href="./go.html?id=efipem_2023">Abrir</a></div></article>
      <article class="card"><h3 class="title">Cuentas p√∫blicas (capitales)</h3><div class="meta"><span class="tag">PBI</span></div><div class="actions"><a class="a primary" href="./go.html?id=cuentas_capitales">Abrir</a></div></article>

      <article class="card"><h3 class="title">Balance CP 2014‚Äì2024</h3><div class="meta"><span class="tag">PBI</span></div><div class="actions"><a class="a primary" href="./go.html?id=balance_cp_2014_2024">Abrir</a></div></article>
      <article class="card"><h3 class="title">Balance proyectado 2025‚Äì2030</h3><div class="meta"><span class="tag">PBI</span></div><div class="actions"><a class="a primary" href="./go.html?id=balance_proj_2025_2030">Abrir</a></div></article>
      <article class="card"><h3 class="title">Balance LDF 2017‚Äì2024</h3><div class="meta"><span class="tag">PBI</span></div><div class="actions"><a class="a primary" href="./go.html?id=balance_ldf_2017_2024">Abrir</a></div></article>
      <article class="card"><h3 class="title">Estado Anal√≠tico de Ingresos (LDF)</h3><div class="meta"><span class="tag">PBI</span></div><div class="actions"><a class="a primary" href="./go.html?id=eai_ldf">Abrir</a></div></article>

      <article class="card"><h3 class="title">Mapas de personal ocupado</h3><div class="meta"><span class="tag">PBI</span></div><div class="actions"><a class="a primary" href="./go.html?id=mapas_personal">Abrir</a></div></article>
      <article class="card"><h3 class="title">Impuesto predial potencial</h3><div class="meta"><span class="tag">PBI</span></div><div class="actions"><a class="a primary" href="./go.html?id=predial_potencial">Abrir</a></div></article>
    </div>

    <!-- Contenedor din√°mico (JS rellena y mejora; si no hay JS, el bloque de arriba funciona igual) -->
    <div id="app" hidden></div>

    <p class="hint" style="margin-top:16px">Tip: los enlaces inician en <code>github.io</code> y registran el clic en servidor antes de llevarte a Power BI.</p>
  </div>
</main>

<!-- JS diferido: solo mejora UX (no bloquea el primer render) -->
<script defer>
const BASE="./go.html";
const REPORTS={
  pe_cap_2015_2024:{name:'Presupuestos de egresos estatales a nivel cap√≠tulo para el periodo 2015 a 2024'},
  pe_2000_2023:{name:'Presupuesto de egresos 2000 a 2023'},
  pe_entidades:{name:'Reporte del presupuesto de egresos por entidad federativa'},
  efipem_1989_2024:{name:'Estad√≠sticas de finanzas p√∫blicas municipales y estatales. EFIPEM 1989-2024'},
  cuentas_capitales:{name:'Cuentas p√∫blicas de los municipios capitales'},
  leyes_2019_2025:{name:'Estad√≠sticas de Leyes de Ingresos 2019-2025'},
  leyes_imp_2019_2025:{name:'Estad√≠sticas de Leyes de Ingresos Impuestos 2019-2025'},
  efipem_2023:{name:'Estad√≠sticas de finanzas p√∫blicas municipales. EFIPEM 2023'},
  efipem_1989_2023:{name:'Estad√≠sticas de finanzas p√∫blicas municipales. EFIPEM 1989-2023'},
  deuda_municipal:{name:'Reporte de deuda p√∫blica municipal'},
  balance_cp_2014_2024:{name:'Balance de Cuentas P√∫blicas (2014-2024)'},
  balance_proj_2025_2030:{name:'Balance de Ingresos y Egresos Proyectados 2025-2030'},
  balance_ldf_2017_2024:{name:'Balance de resultado de ingresos y egresos LDF 2017-2024'},
  eai_ldf:{name:'Estado Anal√≠tico de los Ingresos LDF'},
  mapas_personal:{name:'Mapas de personal ocupado por actividad econ√≥mica'},
  predial_potencial:{name:'Impuesto predial potencial'},
  impuestos_potenciales:{name:'Impuestos potenciales'},
  pronosticos:{name:'Pron√≥sticos'},
  mapas:{name:'Mapas'},
  indicadores:{name:'Indicadores'},
  panorama_hacienda:{name:'Panorama de la Hacienda P√∫blica'},
  ambientales:{name:'Ambientales'},
  deuda:{name:'Deuda'},
  municipal:{name:'Municipal'}
};

const q=document.getElementById('q');
const btnGroup=document.getElementById('toggleGroup');
const btnIds=document.getElementById('toggleIds');
const app=document.getElementById('app');
let grouped=true, showIds=false;

function categorize(id,name){
  const t=(id+" "+name).toLowerCase();
  if(/^pe_/.test(id)) return "Presupuesto de Egresos (PE)";
  if(t.includes("efipem")) return "EFIPEM";
  if(t.includes("leyes")) return "Leyes de Ingresos";
  if(t.includes("balance")) return "Balances";
  if(["pronosticos","impuestos_potenciales","predial_potencial"].includes(id)) return "Modelos y Potenciales";
  if(["mapas","mapas_personal"].includes(id)) return "Mapas";
  if(["indicadores","panorama_hacienda"].includes(id)) return "Indicadores y Panorama";
  if(["deuda","deuda_municipal"].includes(id)) return "Deuda";
  if(id==="municipal") return "Municipal";
  if(id==="ambientales") return "Ambientales";
  return "Otros";
}
function linkFor(id){ return BASE+"?id="+encodeURIComponent(id); }
function esc(s){ return s.replace(/[&<>"]/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c])); }
function card(it){
  return `<article class="card">
    <h3 class="title">${esc(it.name)}</h3>
    ${showIds?`<div class="id">${it.id}</div>`:''}
    <div class="meta"><span class="tag">PBI</span><span class="tag">${esc(it.cat)}</span></div>
    <div class="actions">
      <a class="a" href="${it.link}" rel="noopener">Abrir</a>
      <button class="a" type="button" onclick="navigator.clipboard.writeText('${it.link}')">Copiar</button>
      <a class="a primary" href="${it.link}" rel="noopener">Ir ahora</a>
    </div>
  </article>`;
}
function render(){
  // Oculta el bloque est√°tico y pinta el din√°mico
  document.getElementById('static').hidden=true;
  app.hidden=false;

  const term=q.value.trim().toLowerCase();
  const items=Object.entries(REPORTS).map(([id,v])=>({id,name:v.name,link:linkFor(id),cat:categorize(id,v.name)}))
    .filter(x=>!term||x.id.toLowerCase().includes(term)||x.name.toLowerCase().includes(term));

  if(!grouped){
    app.innerHTML=`<div class="grid">${items.map(card).join("")||`<div class="empty">Sin resultados</div>`}</div>`;
    return;
  }
  const groups={}; for(const it of items){ (groups[it.cat]??=[]).push(it); }
  const order=Object.keys(groups).sort((a,b)=>a.localeCompare(b,'es'));
  app.innerHTML=order.map(cat=>`
    <section>
      <h2 style="font-size:1rem;margin:12px 0 8px">${esc(cat)} <span class="tag">${groups[cat].length}</span></h2>
      <div class="grid">${groups[cat].map(card).join("")}</div>
    </section>`).join("") || `<div class="empty">Sin resultados</div>`;
}
q.addEventListener("input",render);
btnGroup.addEventListener("click",()=>{grouped=!grouped;btnGroup.setAttribute("aria-pressed",String(grouped));render();});
btnIds.addEventListener("click",()=>{showIds=!showIds;btnIds.setAttribute("aria-pressed",String(showIds));render();});

// mejora tras el primer pintado
window.addEventListener('DOMContentLoaded', render, {once:true});
</script>
</body>
</html>
