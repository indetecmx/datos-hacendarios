<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Redirigiendo‚Ä¶ | Datos Hacendarios</title>
<meta name="color-scheme" content="light dark">

<!-- Preconexiones para bajar latencia -->
<link rel="dns-prefetch" href="https://script.google.com">
<link rel="preconnect" href="https://script.google.com" crossorigin>

<style>
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;margin:0;padding:40px;text-align:center}
  .loader{border:4px solid rgba(0,0,0,.12);border-top:4px solid #2f6fed;border-radius:50%;width:36px;height:36px;margin:18px auto;animation:spin 1s linear infinite}
  @keyframes spin{to{transform:rotate(360deg)}}
</style>
</head>
<body>
<h2>Redirigiendo al reporte‚Ä¶</h2>
<p id="msg">Conectando con el servidor.</p>
<div class="loader" role="progressbar" aria-label="Cargando"></div>

<noscript>
  <p>JavaScript est√° deshabilitado. Abre manualmente este enlace (copiar y pegar):</p>
  <!-- Hint: si necesitas, puedes imprimir aqu√≠ un URL base gen√©rico -->
</noscript>

<script>
(function(){
  // CONFIGURA tu Deployment ID:
  const DEPLOY_ID = "AKfycbzHrQSlW2c-hV2myQ3er9WDlMm1DGDJ32YPBQeapF5n4HqS0A5X58jGnXyrttoOv4x8Yg";
  const BASE = `https://script.google.com/macros/s/${DEPLOY_ID}/exec`;

  const p = new URLSearchParams(location.search);
  const id = p.get("id");
  if(!id){
    document.getElementById("msg").textContent = "Falta el par√°metro ?id= en la URL.";
    return;
  }

  // Pasamos 'src' (la propia URL GitHub que invoca), √∫til para 'source' en tu hoja
  const src = location.origin + location.pathname + "?id=" + encodeURIComponent(id);
  const url = `${BASE}?id=${encodeURIComponent(id)}&src=${encodeURIComponent(src)}`;

  // üöÄ Redirecci√≥n inmediata (sin esperas)
  try {
    document.getElementById("msg").textContent = `Abriendo: ${id}`;
    location.replace(url);
  } catch (e) {
    document.getElementById("msg").textContent = "No se pudo redirigir autom√°ticamente. Abre el enlace:";
    const a = document.createElement("a"); a.href = url; a.textContent = url;
    a.rel="noopener"; a.target="_self"; document.body.appendChild(a);
  }
})();
</script>
</body>
</html>
